# Reference this view as omni_dbt__orders
dimensions:
  created_date_dynamic:
    sql: CASE WHEN {{# superstore__orders.timeframe_selector.filter }}'Yearly'{{/
      superstore__orders.timeframe_selector.filter }} THEN DATE_TRUNC('YEAR',
      ${omni_dbt__orders.order_date}) WHEN {{#
      superstore__orders.timeframe_selector.filter }}'Quarterly'{{/
      superstore__orders.timeframe_selector.filter }} THEN DATEADD(DAY, -1,
      DATEADD(QUARTER, 1, DATE_TRUNC('QUARTER',
      ${omni_dbt__orders.order_date}))) WHEN {{#
      superstore__orders.timeframe_selector.filter }}'Monthly'{{/
      superstore__orders.timeframe_selector.filter }} THEN DATE_TRUNC('MONTH',
      ${omni_dbt__orders.order_date}) ELSE NULL END
    label: Dynamic Date
    timeframes: [ date ]

filters:
  timeframe_selector:
    type: string
    suggestion_list:
      - value: Yearly
      - value: Quarterly
      - value: Monthly
    default_filter:
      is: Monthly
    filter_single_select_only: true
custom_compound_primary_key_sql: [ "${omni_dbt__orders.order_id}" ]
